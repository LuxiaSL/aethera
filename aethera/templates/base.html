<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ title | default("æthera") }}{% endblock %}</title>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">

    <!-- Meta tags and SEO -->
    {% block meta %}
    <meta name="description"
        content="{% block description %}thoughts, fragments, and transmissions from the digital aether{% endblock %}">
    {% if canonical_url %}
    <link rel="canonical" href="{{ canonical_url }}">
    {% endif %}
    <meta name="license" content="CC BY 4.0">
    <meta name="robots" content="index, follow, max-image-preview:large">
    <link rel="alternate" type="application/rss+xml" title="æthera RSS Feed" href="/feed.xml" />
    
    <!-- Search Engine Verification (uncomment and add your codes) -->
    <!-- <meta name="google-site-verification" content="YOUR_GOOGLE_VERIFICATION_CODE" /> -->
    <!-- <meta name="msvalidate.01" content="YOUR_BING_VERIFICATION_CODE" /> -->
    {% endblock %}

    <!-- Schema.org structured data -->
    {% block schema %}
    {% if post is defined %}
    <!-- BlogPosting schema for post pages -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "headline": "{{ post.title }}",
        "datePublished": "{{ post.created_at.isoformat() }}",
        "dateModified": "{{ post.updated_at.isoformat() }}",
        "author": {
            "@type": "Person",
            "name": "{{ post.author }}",
            "url": "{{ request.base_url }}"
        },
        "publisher": {
            "@type": "Person",
            "name": "Luxia",
            "url": "{{ request.base_url }}"
        },
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "{% if post.canonical_url %}{{ post.canonical_url }}{% else %}{{ request.url }}{% endif %}"
        },
        {% if post.excerpt %}
        "description": "{{ post.excerpt | replace('"', '\\"') }}",
        {% endif %}
        {% if post.tags %}
        "keywords": "{{ post.tags }}",
        {% endif %}
        "inLanguage": "en",
        "license": "https://creativecommons.org/licenses/by/4.0/",
        "isAccessibleForFree": true,
        "url": "{% if post.canonical_url %}{{ post.canonical_url }}{% else %}{{ request.url }}{% endif %}"
    }
    </script>
    {% else %}
    <!-- Blog schema for home/index page -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Blog",
        "name": "æthera",
        "description": "thoughts, fragments, and transmissions from the digital aether",
        "url": "{{ request.base_url }}",
        "inLanguage": "en",
        "license": "https://creativecommons.org/licenses/by/4.0/",
        "author": {
            "@type": "Person",
            "name": "Luxia",
            "url": "{{ request.base_url }}"
        }
    }
    </script>
    {% endif %}
    {% endblock %}

    <!-- Local Fonts (relies on system fonts or locally served if added later) -->

    <!-- Tailwind CSS (Local) -->
    <link href="/static/vendor/css/tailwind.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/static/css/branding.css" rel="stylesheet">

    <!-- HTMX (Local) -->
    <script src="/static/vendor/js/htmx.min.js"></script>

    {% block extra_head %}{% endblock %}
</head>

<body class="bg-bg text-text">
    <header class="w-full relative">
        <!-- Cyberpunk schematic banner -->
        <div class="banner-container w-full">
            <img src="/static/uploads/banner.png" alt="æthera cybernetic circuit banner"
                class="w-full"
                onerror="this.style.display='none'" />
        </div>

        <div class="max-w-4xl mx-auto px-4 py-6 relative z-10">
            <div class="flex justify-between items-center">
                <h1 class="text-2xl tracking-wide m-0">
                    <a href="/" class="text-text hover:text-accent transition-colors duration-200">æ<span class="font-semibold">thera</span></a>
                </h1>
                <nav class="site-nav">
                    <ul class="flex space-x-6 text-sm m-0 list-none">
                        <li><a href="/" class="text-text-muted hover:text-accent transition-colors duration-200">Home</a></li>
                        <li><a href="/feed.xml" class="text-text-muted hover:text-accent transition-colors duration-200">RSS</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-4 md:pl-20 mt-8">
        {% block content %}{% endblock %}
    </main>

    <footer class="bg-bg-elevated mt-16 py-8 text-center text-text-muted text-sm border-t border-accent-soft">
        <div class="max-w-4xl mx-auto px-4">
            <p>&copy; {{ now().year }} æthera. Licensed under <a
                    href="https://creativecommons.org/licenses/by/4.0/"
                    class="text-text-muted hover:text-accent">CC BY 4.0</a>.</p>
        </div>
    </footer>

    {% block scripts %}{% endblock %}
</body>

</html>